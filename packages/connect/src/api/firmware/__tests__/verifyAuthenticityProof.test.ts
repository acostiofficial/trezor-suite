import { verifyAuthenticityProof } from '../verifyAuthenticityProof';

describe('firmware/verifyAuthenticityProof', () => {
    it('verify success', async () => {
        const verify = await verifyAuthenticityProof({
            signature:
                '3045022100d480cbf9a4cd213288ceb708e240525630677662752887e23a142f8207ea0e3802207dc714c829170dd5a13411c1c7be2cc3a3a201db7526a7c0c56f57405ef87598',
            certificate:
                '3082019a30820140a0030201020204435994ff300a06082a8648ce3d040302304f310b300906035504061302435a311e301c060355040a0c155472657a6f7220436f6d70616e7920732e722e6f2e3120301e06035504030c175472657a6f72204d616e75666163747572696e67204341301e170d3230303931303131343032345a170d3430303931303131343032345a30183116301406035504030c0d5472657a6f72205361666520333059301306072a8648ce3d020106082a8648ce3d030107034200049bbf06dad9ab5905e05471ce16d5222c89c2caa39f26267ac0747129885fbd441bcc7fa84de120a36755daf30a6f47e8c0d4bddc15036ed2a3447dfa7a1d3e88a341303f300e0603551d0f0101ff040403020080300c0603551d130101ff04023000301f0603551d23041830168014a45fea7abaa415deffd19aa03ff100a9dc89ff52300a06082a8648ce3d0403020348003045022100d6123ded0c04b0ab66649f4ba00c3fcf8e2cabe10fb43bfa93f34bcc3be69f4d02202d08ff01ba2272259354e579eb5f079dafece3e200640c63f800db027de959ec',
            challenge: Buffer.from(
                '0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20',
                'hex',
            ),
            caPublicKeys: [
                '0423a5c9ec44dfb96023838d958f6289fa611277ee7af60c3bcb54eff2310546d5ece48b1a507503142b122b53eda53fef3f3d3510f3b7ae2fd5f13614b025ede1',
            ],
        });

        expect(verify).toBe(true);
    });

    it('verify failed (challenge missmatch signature)', async () => {
        const verify = await verifyAuthenticityProof({
            signature:
                '3045022100d480cbf9a4cd213288ceb708e240525630677662752887e23a142f8207ea0e3802207dc714c829170dd5a13411c1c7be2cc3a3a201db7526a7c0c56f57405ef87598',
            certificate:
                '3082019a30820140a0030201020204435994ff300a06082a8648ce3d040302304f310b300906035504061302435a311e301c060355040a0c155472657a6f7220436f6d70616e7920732e722e6f2e3120301e06035504030c175472657a6f72204d616e75666163747572696e67204341301e170d3230303931303131343032345a170d3430303931303131343032345a30183116301406035504030c0d5472657a6f72205361666520333059301306072a8648ce3d020106082a8648ce3d030107034200049bbf06dad9ab5905e05471ce16d5222c89c2caa39f26267ac0747129885fbd441bcc7fa84de120a36755daf30a6f47e8c0d4bddc15036ed2a3447dfa7a1d3e88a341303f300e0603551d0f0101ff040403020080300c0603551d130101ff04023000301f0603551d23041830168014a45fea7abaa415deffd19aa03ff100a9dc89ff52300a06082a8648ce3d0403020348003045022100d6123ded0c04b0ab66649f4ba00c3fcf8e2cabe10fb43bfa93f34bcc3be69f4d02202d08ff01ba2272259354e579eb5f079dafece3e200640c63f800db027de959ec',
            challenge: Buffer.from('00', 'hex'),
            caPublicKeys: [
                '0423a5c9ec44dfb96023838d958f6289fa611277ee7af60c3bcb54eff2310546d5ece48b1a507503142b122b53eda53fef3f3d3510f3b7ae2fd5f13614b025ede1',
            ],
        });

        expect(verify).toBe(false);
    });

    // it('verify failed (caPublicKey missmatch)', async () => {
    //     const verify = await verifyAuthenticityProof({
    //         signature:
    //             '3045022100d480cbf9a4cd213288ceb708e240525630677662752887e23a142f8207ea0e3802207dc714c829170dd5a13411c1c7be2cc3a3a201db7526a7c0c56f57405ef87598',
    //         certificate:
    //             '3082019a30820140a0030201020204435994ff300a06082a8648ce3d040302304f310b300906035504061302435a311e301c060355040a0c155472657a6f7220436f6d70616e7920732e722e6f2e3120301e06035504030c175472657a6f72204d616e75666163747572696e67204341301e170d3230303931303131343032345a170d3430303931303131343032345a30183116301406035504030c0d5472657a6f72205361666520333059301306072a8648ce3d020106082a8648ce3d030107034200049bbf06dad9ab5905e05471ce16d5222c89c2caa39f26267ac0747129885fbd441bcc7fa84de120a36755daf30a6f47e8c0d4bddc15036ed2a3447dfa7a1d3e88a341303f300e0603551d0f0101ff040403020080300c0603551d130101ff04023000301f0603551d23041830168014a45fea7abaa415deffd19aa03ff100a9dc89ff52300a06082a8648ce3d0403020348003045022100d6123ded0c04b0ab66649f4ba00c3fcf8e2cabe10fb43bfa93f34bcc3be69f4d02202d08ff01ba2272259354e579eb5f079dafece3e200640c63f800db027de959ec',
    //         challenge: Buffer.from('00', 'hex'),
    //         caPublicKeys: [
    //             '0423a5c9ec44dfb96023838d958f6289fa611277ee7af60c3bcb54eff2310546d5ece48b1a507503142b122b53eda53fef3f3d3510f3b7ae2fd5f13614b025ede1',
    //         ],
    //     });

    //     expect(verify).toBe(false);
    // });
});
